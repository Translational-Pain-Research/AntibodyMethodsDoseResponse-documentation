<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Uncertainty estimation · AntibodyMethodsDoseResponse</title><meta name="title" content="Uncertainty estimation · AntibodyMethodsDoseResponse"/><meta property="og:title" content="Uncertainty estimation · AntibodyMethodsDoseResponse"/><meta property="twitter:title" content="Uncertainty estimation · AntibodyMethodsDoseResponse"/><meta name="description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="og:description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="twitter:description" content="Documentation for AntibodyMethodsDoseResponse."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="AntibodyMethodsDoseResponse logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">AntibodyMethodsDoseResponse</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../QuickStart/">Quick start</a></li><li><span class="tocitem">Detailed explanations</span><ul><li><a class="tocitem" href="../MeasurementData/">Measurement data</a></li><li><a class="tocitem" href="../Models/">Models</a></li><li><a class="tocitem" href="../ResultsAndSimulations/">Results and simulations</a></li><li><a class="tocitem" href="../DensityPlots/">Density plots for <code>OneDimGrid</code></a></li><li><a class="tocitem" href="../Fitting/">Fitting</a></li><li class="is-active"><a class="tocitem" href>Uncertainty estimation</a><ul class="internal"><li><a class="tocitem" href="#[EpitopeUncertainty](@ref)-construction"><span><code>EpitopeUncertainty</code> - construction</span></a></li><li><a class="tocitem" href="#EpitopeUncertainty-plotting"><span><code>EpitopeUncertainty</code> - plotting</span></a></li><li><a class="tocitem" href="#[DoseResponseUncertainty](@ref)-construction"><span><code>DoseResponseUncertainty</code> - construction</span></a></li><li><a class="tocitem" href="#DoseResponseUncertainty-plotting"><span><code>DoseResponseUncertainty</code> - plotting</span></a></li><li><a class="tocitem" href="#Plotting-with-[uncertainty_plot](@ref)"><span>Plotting with <code>uncertainty_plot</code></span></a></li><li><a class="tocitem" href="#Rescale-the-bin-wise-shifts"><span>Rescale the bin-wise shifts</span></a></li><li><a class="tocitem" href="#of_single_peak"><span>Example: Uncertainty of a single peak</span></a></li><li><a class="tocitem" href="#in_single_peak"><span>Example: Uncertainty in a single peak</span></a></li><li><a class="tocitem" href="#global_uncertainty"><span>Example: Global uncertainty</span></a></li><li><a class="tocitem" href="#individual_uncertainty"><span>Example: Individual uncertainty</span></a></li><li><a class="tocitem" href="#total_uncertainty"><span>Example: Total uncertainty</span></a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/">AntibodyMethodsDoseResponse</a></li><li><a class="tocitem" href="../API_Convenience/">AntibodyMethodsDoseResponseConvenience</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Detailed explanations</a></li><li class="is-active"><a href>Uncertainty estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Uncertainty estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponse.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponse.jl/blob/main/docs/src/Uncertainty.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Uncertainty-estimation"><a class="docs-heading-anchor" href="#Uncertainty-estimation">Uncertainty estimation</a><a id="Uncertainty-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Uncertainty-estimation" title="Permalink"></a></h1><p>The posterior and log-posterior objectives (as used in the <a href="../Fitting/#fitting">Fitting tutorial</a>) from <a href="https://antibodypackages.github.io/FittingObjectiveFunctions-documentation/"><code>FittingObjectiveFunctions.jl</code></a> belong to a Bayesian data analysis approach. In this analysis regime, it is important to consider not only the best fit but also less probable parameters to estimate the uncertainty of the fit result.</p><h2 id="[EpitopeUncertainty](@ref)-construction"><a class="docs-heading-anchor" href="#[EpitopeUncertainty](@ref)-construction"><a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> - construction</a><a id="[EpitopeUncertainty](@ref)-construction-1"></a><a class="docs-heading-anchor-permalink" href="#[EpitopeUncertainty](@ref)-construction" title="Permalink"></a></h2><p>The <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> type collects and stores the uncertainty of a <span>$K_\tau$</span>-density. To illustrate how to obtain an uncertainty estimation, we consider the adaptive fit results from the <a href="../Fitting/#fitting">Fitting tutorial</a>:</p><img src="079496d7.svg" alt="Example block output"/><p>A question of interest could be the uncertainty of the individual peaks. For this, the index-bins belonging to the different peaks need to be identified. Using <a href="../API/#AntibodyMethodsDoseResponse.peak_detection"><code>peak_detection</code></a> and setting the threshold to <code>0.01</code> results in:</p><pre><code class="language-julia hljs">bins, ranges = peak_detection(adaptive_result.grid, 0.01)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([[5, 6, 7, 8, 9, 10, 11, 12, 13, 14], [16, 17, 18, 19, 20, 21, 22, 23, 24], [26, 27, 28, 29, 30, 31, 32], [1, 2, 3, 4], [15], [25]], [[1.2500875e-7, 7.103454589843753e-6], [1.3206909179687505e-5, 0.0007822421875000004], [0.0015634843750000006, 0.10000000000000005], [1.0000000000001413e-11, 1.2500875e-7], [7.1034545898437526e-6, 1.3206909179687506e-5], [0.0007822421875000004, 0.0015634843750000009]])</code></pre><p><a href="../API/#AntibodyMethodsDoseResponse.peak_detection"><code>peak_detection</code></a> returns the identified peaks both as bins (indices of intervals) and the grid-domain ranges. By default, the regions between peaks are also included (<code>fill = true</code>) and the peaks are determined with <code>volume_normalization = :log</code> (see <a href="../DensityPlots/#log_volume_normalization">Background: log-volume normalization</a>).</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>For plotting purposes (<a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.bin_analysis_plot"><code>bin_analysis_plot</code></a>, <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.peak_analysis_plot"><code>peak_analysis_plot</code></a>), the bins need to specify the grid-domain ranges, e.g. <code>[[1e-10,1e-8],[1e-5,1e-3]]</code>. For the uncertainty estimation and uncertainty plotting (<a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.uncertainty_plot"><code>uncertainty_plot</code></a>), the bins need to specify the grid intervals that are varied, e.g. <code>[[1,2,3],[5,8]]</code>.</p></div></div><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Defining grid-domain ranges is often easier than figuring out which gird intervals belong to those ranges. The <a href="https://antibodypackages.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.select_indices"><code>select_indices</code></a> function allows to pick the interval indices belonging to a gird-domain range.</p></div></div><p>Having defined the interval groups of interest, the uncertainty can be estimated by fixing all parameters to the fit result, shifting uniformly only the parameters belonging to the current group of interest. This process is then repeated for all interval groups. Evaluating the objective function for each shift allows to estimate the uncertainty of the interval group.</p><p><img src="../assets/UncertaintyShift.svg" alt="UncertaintyShift"/></p><p>This uncertainty estimation from bin-wise shifting can be obtained with the following <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> constructor:</p><pre><code class="language-julia hljs">adaptive_options = AdaptiveOptions(objective = :log_posterior, 
		prior_generator = scaled_log_volume_prior(500),
		offset = adaptive_result.optimizer[end]
		)

eu = EpitopeUncertainty(data,adaptive_result.grid, bins, 
		levels = [1e-10,1e-5,0.1,0.25,0.5,0.75,0.9,1], 
		options = adaptive_options
		)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EpitopeUncertainty([1.0e-10, 1.0e-5, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0], [0.002656958570482257 0.0 … 0.0 0.0; 0.0033194616388737474 0.0 … 0.0 0.0; … ; 0.004641031432126458 0.00030003000300030005 … 0.007353045427095161 0.003751872468798145; 0.004641031432126458 0.00030003000300030005 … 0.01171345131205015 0.008112278353753133], [0.0058411514441276575 0.0015001500150015 … 0.07661994196111506 0.07301876900281805; 0.005441111440127258 0.0011001100110011 … 0.05761804177109606 0.05401686881279904; … ; 0.004641031432126458 0.00030003000300030005 … 0.01611389135605455 0.012512718397757534; 0.004641031432126458 0.00030003000300030005 … 0.01171345131205015 0.008112278353753133], nothing, nothing)</code></pre><p>The bin-wise shifting constructor <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> generates the objective function automatically, using the same methods as <a href="../API/#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>adaptive_dose_response_fit</code></a>, hence the need for an <a href="../API/#AntibodyMethodsDoseResponse.AdaptiveOptions"><code>AdaptiveOptions</code></a> object. In the example above, the options were chosen to match those from the <a href="../Fitting/#fitting">Fitting tutorial</a> section.</p><p>Notice the <code>offset = adaptive_result.optimizer[end]</code> line. Since the default fitting algorithm that was recreated in the <a href="../Fitting/#fitting">Fitting tutorial</a> section uses the offset parameter, the estimated offset must be added to the uncertainty estimation, as it shifts up the resulting dose-response curve globally. Recall, that the offset parameter is the last element of the returned <code>optimizer</code> field of an <a href="../API/#AntibodyMethodsDoseResponse.AdaptiveResult"><code>AdaptiveResult</code></a> object.</p><p>Finally, the uncertainty levels are specified as fractions of the best objective value.</p><div class="admonition is-info"><header class="admonition-header">Uncertainty estimation from samples</header><div class="admonition-body"><p>There is also an <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> constructor that uses samples, drawn from a posterior or log-posterior objective. However, the sample constructor does not support the selection of bins. Quantiles corresponding to the chosen levels are calculated for each parameter individually. Furthermore, no sample algorithm is provided by the <code>AntibodyMethods</code> packages.</p></div></div><h2 id="EpitopeUncertainty-plotting"><a class="docs-heading-anchor" href="#EpitopeUncertainty-plotting"><a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> - plotting</a><a id="EpitopeUncertainty-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#EpitopeUncertainty-plotting" title="Permalink"></a></h2><p><a href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponseRecipes.jl"><code>AntibodyMethodsDoseResponseRecipes.jl</code></a>provides a plotting recipe for <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> objects. To define the color-gradient for the uncertainty visualization, <a href="https://juliagraphics.github.io/Colors.jl/stable/"><code>Colors.jl</code></a> is used here. Both packages (and also <a href="https://docs.juliaplots.org/stable/"><code>Plots.jl</code></a>) are automatically exported by <a href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponseConvenience.jl"><code>AntibodyMethodsDoseResponseConvenience.jl</code></a>. The <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object <code>eu</code> can be plotted by passing the grid <code>adaptive_result.grid</code> and the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object <code>eu</code> to the <code>plot</code> function:</p><pre><code class="language-julia hljs">uncertainty_colors =colormap(&quot;RdBu&quot;, 8)[end:-1:1]
plot(adaptive_result.grid, eu, xaxis = :log, legend = :topleft,
	colors = uncertainty_colors,
	hide_labels = false,
	bins = bins
	)</code></pre><img src="5a334f5f.svg" alt="Example block output"/><p>The <code>colormap</code> function from <a href="https://juliagraphics.github.io/Colors.jl/stable/"><code>Colors.jl</code></a> creates an array of colors (here <code>8</code> colors, which matches the number of uncertainty <code>levels</code>). The <code>[end:-1:1]</code> is used to reverse the colors (now from blue to red). Thus, the lower levels (less certain) are blue while the best result is red.</p><h4 id="Keywords-with-default-arguments"><a class="docs-heading-anchor" href="#Keywords-with-default-arguments">Keywords with default arguments</a><a id="Keywords-with-default-arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Keywords-with-default-arguments" title="Permalink"></a></h4><ul><li><code>volume_normalization = :log</code>: The volume-normalization as discussed in <a href="../DensityPlots/#log_volume_normalization">Background: log-volume normalization</a>.</li><li><code>colors = [:gray]</code>: An array of colors (that <a href="https://docs.juliaplots.org/stable/"><code>Plots.jl</code></a> accepts for the <code>color</code> keyword) that correspond to the different uncertainty levels. If the array contains less colors than uncertainty levels, the last color is repeated for the remaining levels.</li><li><code>opacities = [1]</code>: Array of opacities (number between <code>0</code> and <code>1</code>) that correspond to the different uncertainty levels. Again, the last opacity is repeated if there are more uncertainty levels than opacities.</li><li><code>reverse = false</code>: If <code>true</code> the plotting order of the uncertainty levels is reversed. Since the uncertainty ranges are plotted on top of each other, this can become necessary when the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> constructor for samples is used, where larger levels correspond to larger uncertainty (as opposed to the bin-wise shifting constructor). </li><li><code>hide_labels = true</code>: If <code>true</code> the labels are omitted. Can become necessary when a large number of uncertainty levels is used.</li><li><code>bins = nothing</code>: Specifies the positions for the bin-markers (dashed lines). The bins should be the same as those used in the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> constructor. If <code>nothing</code>, bin markers are omitted.</li><li><code>bin_color = :gray</code>: Color of the bin markers.</li></ul><div class="admonition is-warning"><header class="admonition-header">Interpretation of the uncertainty</header><div class="admonition-body"><p>As explained above, the uncertainty is estimated by keeping all bins fixed, only shifting one bin at a time. Thus, the bin uncertainties have to be considered individually. </p><p>It is not admissible to combine the uncertainty of the bins: E.g. to consider shifting the first peak up and shifting the second peak down within the <code>1e-10</code> uncertainty region and then to declare this to have the uncertainty <code>1e-10</code>.</p><p>It is not admissible to consider partial shifts within a bin: E.g. shifting only the tip of the first peak, but not the other parts of the peak. The uncertainty level is only valid for the uniform shift of all parameters within a bin.</p></div></div><h2 id="[DoseResponseUncertainty](@ref)-construction"><a class="docs-heading-anchor" href="#[DoseResponseUncertainty](@ref)-construction"><a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> - construction</a><a id="[DoseResponseUncertainty](@ref)-construction-1"></a><a class="docs-heading-anchor-permalink" href="#[DoseResponseUncertainty](@ref)-construction" title="Permalink"></a></h2><p>Given an <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object and the corresponding grid, a <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> object can be created. In essence, the dose-response uncertainty is obtained by simulating dose-response curves for the different parameters contained in the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object. Hence, the concentrations for which these dose-responses curves are simulated need to be passed explicitly:</p><pre><code class="language-julia hljs">concentrations = LogRange(extrema(data.independent)...,100)
du = DoseResponseUncertainty(adaptive_result.grid, eu, concentrations, bins = bins)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DoseResponseUncertainty([1.0e-10, 1.0e-5, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0], [1.0e-10, 1.2045035402587787e-10, 1.4508287784959432e-10, 1.747528400007683e-10, 2.104904144512022e-10, 2.5353644939701164e-10, 3.0538555088334126e-10, 3.6783797718286343e-10, 4.4306214575838866e-10, 5.336699231206324e-10  …  0.0018738174228603867, 0.002257019719633926, 0.002718588242732946, 0.0032745491628777385, 0.0039442060594376644, 0.004750810162102803, 0.0057223676593502314, 0.00689261210434971, 0.00830217568131977, 0.010000000000000016], [0.0001774032545570366 0.0002136262223708477 … 1.9868482282342876 1.993519904290508; 0.00018581863312689605 0.00022374936552187015 … 2.026230180545118 2.0329018566013413; … ; 0.00019877982736535017 0.0002393408006512052 … 2.10752040942335 2.1130279076607974; 0.00019879462653927038 0.00023935862630296227 … 2.121145003790755 2.127816584369282], [0.00022902990642177637 0.0002757428159719937 … 2.3263716436172515 2.3503726443554207; 0.00022096716858462337 0.00026604036956700763 … 2.2663344611144596 2.285262162682801; … ; 0.00020484169291031735 0.0002466354767570356 … 2.135200615121518 2.1430471632399732; 0.00020484169291031735 0.0002466354767570356 … 2.1242975676245592 2.13096924646158])</code></pre><p>The same <code>bins</code> that were used to create the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object should also be used for the <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> constructor. This is, because the dose-response uncertainty is calculated as point-wise maximum/minimum over the effect of the individual uncertainty-variation of each bin. The following example illustrates the dose-response uncertainties that result from the individual peak uncertainties (dashed lines), both for the same uncertainty level. The green ribbon shows the resulting overall dose-response uncertainty (for the same uncertainty level):</p><img src="0aa1702e.svg" alt="Example block output"/><p>Note that the <code>concentrations</code> array covers the same concentration range as the dose-response data points, but contains much more intermediate concentrations:</p><pre><code class="language-julia hljs">println(data.independent)
println(concentrations)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[1.0e-10, 3.414548873833601e-10, 1.1659144011798312e-9, 3.981071705534969e-9, 1.3593563908785241e-8, 4.641588833612773e-8, 1.584893192461114e-7, 5.411695265464649e-7, 1.8478497974222906e-6, 6.309573444801943e-6, 2.1544346900318823e-5, 7.356422544596421e-5, 0.0002511886431509585, 0.0008576958985908955, 0.0029286445646252404, 0.01000000000000001]
[1.0e-10, 1.2045035402587787e-10, 1.4508287784959432e-10, 1.747528400007683e-10, 2.104904144512022e-10, 2.5353644939701164e-10, 3.0538555088334126e-10, 3.6783797718286343e-10, 4.4306214575838866e-10, 5.336699231206324e-10, 6.428073117284319e-10, 7.742636826811277e-10, 9.326033468832218e-10, 1.1233240329780266e-9, 1.353047774579813e-9, 1.6297508346206469e-9, 1.9630406500402685e-9, 2.364489412645407e-9, 2.848035868435805e-9, 3.430469286314912e-9, 4.132012400115335e-9, 4.977023564332114e-9, 5.994842503189421e-9, 7.2208090183854565e-9, 8.697490026177834e-9, 1.0476157527896662e-8, 1.261856883066021e-8, 1.519911082952933e-8, 1.8307382802953696e-8, 2.2051307399030457e-8, 2.656087782946684e-8, 3.1992671377973846e-8, 3.8535285937105434e-8, 4.641588833612773e-8, 5.5908101825122226e-8, 6.734150657750842e-8, 8.111308307896888e-8, 9.770099572992247e-8, 1.1768119524350015e-7, 1.4174741629268078e-7, 1.7073526474706888e-7, 2.0565123083486556e-7, 2.477076355991714e-7, 2.98364724028334e-7, 3.593813663804633e-7, 4.3287612810830616e-7, 5.214008287999684e-7, 6.28029144183426e-7, 7.564633275546291e-7, 9.111627561154906e-7, 1.097498765493059e-6, 1.3219411484660286e-6, 1.592282793341094e-6, 1.9179102616724926e-6, 2.310129700083158e-6, 2.782559402207126e-6, 3.351602650938848e-6, 4.037017258596558e-6, 4.862601580065354e-6, 5.857020818056673e-6, 7.0548023107186455e-6, 8.497534359086439e-6, 1.023531021899027e-5, 1.2328467394420658e-5, 1.4849682622544697e-5, 1.788649529057435e-5, 2.1544346900318823e-5, 2.5950242113997427e-5, 3.1257158496882356e-5, 3.7649358067924715e-5, 4.534878508128591e-5, 5.462277217684337e-5, 6.579332246575683e-5, 7.924828983539186e-5, 9.545484566618347e-5, 0.00011497569953977369, 0.00013848863713938745, 0.0001668100537200059, 0.00020092330025650479, 0.0002420128264794386, 0.00029150530628251786, 0.0003511191734215138, 0.00042292428743895033, 0.0005094138014816386, 0.0006135907273413188, 0.000739072203352579, 0.0008902150854450411, 0.0010722672220103253, 0.0012915496650148853, 0.0015556761439304754, 0.0018738174228603867, 0.002257019719633926, 0.002718588242732946, 0.0032745491628777385, 0.0039442060594376644, 0.004750810162102803, 0.0057223676593502314, 0.00689261210434971, 0.00830217568131977, 0.010000000000000016]</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Using more intermediate concentrations is recommended to avoid jagged lines.</p></div></div><h2 id="DoseResponseUncertainty-plotting"><a class="docs-heading-anchor" href="#DoseResponseUncertainty-plotting"><a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> - plotting</a><a id="DoseResponseUncertainty-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#DoseResponseUncertainty-plotting" title="Permalink"></a></h2><p>As before, <a href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponseRecipes.jl"><code>AntibodyMethodsDoseResponseRecipes.jl</code></a> provides a plotting recipe for <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> objects:</p><pre><code class="language-julia hljs">plot(du, xaxis = :log, legend = :topleft, colors = uncertainty_colors, hide_labels = false)
scatter!(data, color = &quot;Dark Orange&quot;, label = &quot;data&quot;) # compare uncertainty with data</code></pre><img src="f048eb01.svg" alt="Example block output"/><h4 id="Keywords-with-default-arguments-2"><a class="docs-heading-anchor" href="#Keywords-with-default-arguments-2">Keywords with default arguments</a><a class="docs-heading-anchor-permalink" href="#Keywords-with-default-arguments-2" title="Permalink"></a></h4><ul><li><code>filter_zeros = [true, false]</code>: Remove zero-values from the plot (works the same as explained in <a href="../MeasurementData/#measurement_data_plotting">Measurement data - Plotting</a>).</li><li><code>colors = [:gray]</code>: Same as <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> plotting above.</li><li><code>opacities = [1]</code>: Same as <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> plotting above.</li><li><code>reverse = false</code>: Same as <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> plotting above.</li><li><code>hide_labels = true</code>: Same as <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> plotting above.</li></ul><div class="admonition is-warning"><header class="admonition-header">Interpretation of the uncertainty</header><div class="admonition-body"><p>As explained above, the uncertainty is estimated by keeping all bins fixed, only using the uncertainty estimation of one bin at a time. Then, the dose-response curves are simulated for all individual bin uncertainties. Finally, for each concentration the maximal/minimal response value is collected by considering all individual bin uncertainties.  Thus, comparing the dose-response uncertainty with the uncertainty of an individual peak is not directly possible. It rather shows the worst-case uncertainty if any of the peaks (but only one) would be shifted within a certain uncertainty level.</p><p>Nevertheless, it is possible to gauge the uncertainty effect of a single peak, by considering only the concentration region of the dose-response curve that matches the <span>$K_\tau$</span> region of the peak.</p></div></div><div class="admonition is-info"><header class="admonition-header">Why component wise maxima/minima?</header><div class="admonition-body"><p>The component-wise maxima/minima are just a compromised way to combine the uncertainty corresponding to all the individual peaks into a single plot. Using a different plot for each peak would be less confusing, but less concise. Also, the component-wise maxima/minima do not correspond to the overall uncertainty, i.e. when all peaks are shifted within an uncertainty level at the same time. <a href="#total_uncertainty">Example: Total uncertainty</a> shows how to obtain the total dose-response uncertainty.</p></div></div><div class="admonition is-success"><header class="admonition-header">Different plots for different aspects</header><div class="admonition-body"><p>Combining to many aspects into a single plot leads to misinterpretation. Choosing different bins allows to obtain different uncertainty estimations, as the examples below show.</p></div></div><h2 id="Plotting-with-[uncertainty_plot](@ref)"><a class="docs-heading-anchor" href="#Plotting-with-[uncertainty_plot](@ref)">Plotting with <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.uncertainty_plot"><code>uncertainty_plot</code></a></a><a id="Plotting-with-[uncertainty_plot](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-with-[uncertainty_plot](@ref)" title="Permalink"></a></h2><p>Since the uncertainty estimation involves various subtleties, it is not discussed in the <a href="../QuickStart/#quick_start">quick start guide</a>. However, <a href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponseConvenience.jl"><code>AntibodyMethodsDoseResponseConvenience.jl</code></a> contains a convenience function (<a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.uncertainty_plot"><code>uncertainty_plot</code></a>) to create the uncertainty plots. The available methods to customize the plots are discussed in <a href="../QuickStart/#plotting_options">quick start: plotting options</a>.</p><p>The plots from above can be recreated with <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.uncertainty_plot"><code>uncertainty_plot</code></a>:</p><pre><code class="language-julia hljs">du_plot, eu_plot = uncertainty_plot(eu,du,adaptive_result.grid,
		eu_arguments = eu_options(8, bins, hide_labels = false),
		du_arguments = du_options(8, hide_labels = false)
		)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Plot{Plots.GRBackend() n=8}, Plot{Plots.GRBackend() n=20})</code></pre><p>Both <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.eu_options"><code>eu_options</code></a> and <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.du_options"><code>du_options</code></a> expect the number of uncertainty levels as first argument. <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.eu_options"><code>eu_options</code></a> takes the <code>bins</code> as second, optional argument. Then, the respective uncertainty-plot keywords discussed above can be added to <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.eu_options"><code>eu_options</code></a> and <a href="../API_Convenience/#AntibodyMethodsDoseResponseConvenience.du_options"><code>du_options</code></a>.</p><pre><code class="language-julia hljs">plot(eu_plot)</code></pre><img src="5abf20b0.svg" alt="Example block output"/><pre><code class="language-julia hljs">plot(du_plot)
scatter!(data, color = &quot;Dark Orange&quot;, label = &quot;data&quot;) # plot data points on top</code></pre><img src="afd3b796.svg" alt="Example block output"/><h2 id="Rescale-the-bin-wise-shifts"><a class="docs-heading-anchor" href="#Rescale-the-bin-wise-shifts">Rescale the bin-wise shifts</a><a id="Rescale-the-bin-wise-shifts-1"></a><a class="docs-heading-anchor-permalink" href="#Rescale-the-bin-wise-shifts" title="Permalink"></a></h2><p>By default (<code>volume_normalization = :none</code>), all weights within the same bin are shifted uniformly. However, the corresponding intervals may have different lengths. And the contribution of an interval is given by the product <code>weight × interval length</code>. Hence, scaling the wight shifts according to their corresponding interval length provides further uncertainty estimation methods from bin-wise weight shifting. For this, the <code>volume_normalization = :linear</code> keyword can be used in the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> constructor, leading to</p><img src="cb5d2694.svg" alt="Example block output"/><p>Observe that the shifts become larger for larger <span>$K_\tau$</span> values. Although the intervals appear to have the same lengths, the intervals further right in the plot are larger, because of the logarithmic plot. Hence, the shifts, when scaled by the interval length, become larger. Note that this behavior is universal, i.e. not necessarily depending on the uncertainty itself but on the fact of the unequal size of logarithmically sized intervals.</p><p>As mentioned in <a href="../DensityPlots/#log_volume_normalization">Background: log-volume normalization</a>, it is in fact the visual area of the intervals in the logarithmic plot that corresponds to the dose-response effect of the interval. Thus, scaling the shifts with the visual lengths of the intervals, as they appear in a logarithmic plot, is another approach to investigate the uncertainty with bin-wise weight shifting. This can be achieved by <code>volume_normalization = :log</code>:</p><img src="68edc7a0.svg" alt="Example block output"/><p>Since the intervals have almost the same length in the logarithmic plot, the shifts are almost identical (for the respective bin).</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In summary, the different re-scalings of the shifts provide additional methods to investigate the uncertainty. Since bin-wise shifts only approximate the uncertainty roughly (as sampling is computationally expensive), different scalings reveal different aspects of the uncertainty, by testing different configuration of deviations from the best fit. Hence, no scaling is superior to the others, they just answer slightly different questions about the uncertainty.</p></div></div><h2 id="of_single_peak"><a class="docs-heading-anchor" href="#of_single_peak">Example: Uncertainty of a single peak</a><a id="of_single_peak-1"></a><a class="docs-heading-anchor-permalink" href="#of_single_peak" title="Permalink"></a></h2><p>The interpretation of the uncertainty plots can be tricky at times, which is addressed by the warnings above. In the example above, it is not possible to compare the dose-response uncertainty with the uncertainty of a single bin. To do so, the uncertainty estimation needs to be restricted to a single peak:</p><pre><code class="language-julia hljs">temp_bins, temp_ranges = peak_detection(adaptive_result.grid, 0.01)
bins = [temp_bins[2]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[[16, 17, 18, 19, 20, 21, 22, 23, 24]]</code></pre><p>Using <code>[temp_bins[2]]</code> creates a vector of bins, in this case with only a single bin - the second peak from left. Simply using <code>temp_bins[2]</code> will not work; it will create separate bins, each containing only a single element.</p><p>Now, the uncertainty estimation proceeds as before:</p><pre><code class="language-julia hljs">adaptive_options = AdaptiveOptions(objective = :log_posterior, 
		prior_generator = scaled_log_volume_prior(500),
		offset = adaptive_result.optimizer[end]
		)

eu = EpitopeUncertainty(data,adaptive_result.grid, bins, 
		levels = [1e-10,1e-5,0.1,0.25,0.5,0.75,0.9,1], 
		options = adaptive_options
		)

concentrations = LogRange(extrema(data.independent)...,100)
du = DoseResponseUncertainty(adaptive_result.grid, eu, concentrations, bins = bins)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DoseResponseUncertainty([1.0e-10, 1.0e-5, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0], [1.0e-10, 1.2045035402587787e-10, 1.4508287784959432e-10, 1.747528400007683e-10, 2.104904144512022e-10, 2.5353644939701164e-10, 3.0538555088334126e-10, 3.6783797718286343e-10, 4.4306214575838866e-10, 5.336699231206324e-10  …  0.0018738174228603867, 0.002257019719633926, 0.002718588242732946, 0.0032745491628777385, 0.0039442060594376644, 0.004750810162102803, 0.0057223676593502314, 0.00689261210434971, 0.00830217568131977, 0.010000000000000016], [0.00021470843960851382 0.0002552217099355332 … 1.9865204429274776 1.993192118983698; 0.0002147826528591809 0.0002553111000302242 … 2.025730421647432 2.0324020977036548; … ; 0.0002149410439908186 0.00025550188264845193 … 2.1122203265785773 2.118892004729177; 0.00021495651447645886 0.0002555205168973023 … 2.1213134294695 2.127985108306521], [0.00021518928143722432 0.0002558008854372385 … 2.2581270999038288 2.264798789068644; 0.00021512037016594506 0.0002557178815931785 … 2.217623052735771 2.2242947388430157; … ; 0.0002149718280922987 0.0002555389621959824 … 2.13031432884018 2.1369860083566605; 0.00021495651447645886 0.0002555205168973023 … 2.1213134294695 2.127985108306521])</code></pre><p>These uncertainty objects produce the following plots:</p><img src="e69c6a18.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Interpretation</header><div class="admonition-body"><p>In this case, the uncertainty of the dose-response curve corresponds exclusively to the uncertainty of the middle peak (other uncertainties have not been estimated).</p></div></div><h2 id="in_single_peak"><a class="docs-heading-anchor" href="#in_single_peak">Example: Uncertainty in a single peak</a><a id="in_single_peak-1"></a><a class="docs-heading-anchor-permalink" href="#in_single_peak" title="Permalink"></a></h2><p>In the example above, the use of <code>[temp_bins[2]]</code> was emphasized. Using <code>temp_bins[2]</code> will create single-element bins (that are contained in the bin <code>temp_bin[2]</code>). Internally, single-element arrays are converted to <code>[[elm] for elm in collection]</code>.</p><p>But it is worthwhile to consider this case. It corresponds to the uncertainty of the individual parameters in <code>temp_bin[2]</code>, where one parameter at a time is varied, keeping the rest fixed to the best fit result.</p><pre><code class="language-julia hljs">temp_bins, temp_ranges = peak_detection(adaptive_result.grid, 0.01)
bins = temp_bins[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[16, 17, 18, 19, 20, 21, 22, 23, 24]</code></pre><p>The uncertainty estimation and plotting work as before:</p><img src="a9e625cb.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Interpretation</header><div class="admonition-body"><p>The same warnings as before apply. The uncertainty of only the individual parameters (in this case) can be deduced from this plot, as is also indicated by the bin markers. It is not valid to combine the uncertainties (e.g. move one parameter up and its neighbor down). Also, the uncertainty of a single parameter cannot be compared directly to the dose-response uncertainty. </p></div></div><h2 id="global_uncertainty"><a class="docs-heading-anchor" href="#global_uncertainty">Example: Global uncertainty</a><a id="global_uncertainty-1"></a><a class="docs-heading-anchor-permalink" href="#global_uncertainty" title="Permalink"></a></h2><p>The example <a href="#of_single_peak">Uncertainty of a single peak</a> indicates how to estimate the global-shift uncertainty:</p><pre><code class="language-julia hljs">bins = [collect(1:length(adaptive_result.grid))]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Vector{Int64}}:
 [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  23, 24, 25, 26, 27, 28, 29, 30, 31, 32]</code></pre><p>The uncertainty estimation and plotting work as before:</p><img src="aa095abb.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Interpretation</header><div class="admonition-body"><p>Here, the complete <span>$K_\tau$</span>-density is shifted (globally). Since this is the only &quot;bin&quot;, the dose-response uncertainty corresponds directly to this uncertainty. Again, it is not admissible to consider individual parameters/peaks/parts moving in different directions. The result is only valid for global/uniform shifts. </p></div></div><h2 id="individual_uncertainty"><a class="docs-heading-anchor" href="#individual_uncertainty">Example: Individual uncertainty</a><a id="individual_uncertainty-1"></a><a class="docs-heading-anchor-permalink" href="#individual_uncertainty" title="Permalink"></a></h2><p>The example <a href="#in_single_peak">Uncertainty in a single peak</a> indicates how to estimate the uncertainty for all parameters individually:</p><pre><code class="language-julia hljs">bins = collect(1:length(adaptive_result.grid))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]</code></pre><p>The uncertainty estimation and plotting work as before:</p><img src="09395bb3.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Interpretation</header><div class="admonition-body"><p>The same warnings as before apply. The uncertainty of only the individual parameters (in this case) can be deduced from this plot, as is also indicated by the bin markers. It is not valid to combine the uncertainties (e.g. move one parameter up and its neighbor down). Also, the uncertainty of a single parameter cannot be compared directly to the dose-response uncertainty. </p></div></div><h2 id="total_uncertainty"><a class="docs-heading-anchor" href="#total_uncertainty">Example: Total uncertainty</a><a id="total_uncertainty-1"></a><a class="docs-heading-anchor-permalink" href="#total_uncertainty" title="Permalink"></a></h2><p>So far, the same <code>bins</code> were used for both the <a href="../API/#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> and the <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a>. But, this is not a requirement. It is possible to combine different bins to obtain different uncertainty visualizations. For example, this allows to estimate the total uncertainty of the dose-response curve. For this, the uncertainties of the individual parameters of the <span>$K_\tau$</span> density are estimated as in <a href="#individual_uncertainty">Example: Individual uncertainty</a>:</p><pre><code class="language-julia hljs">epitope_bins = collect(1:length(adaptive_result.grid))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]</code></pre><pre><code class="language-julia hljs">adaptive_options = AdaptiveOptions(objective = :log_posterior, 
		prior_generator = scaled_log_volume_prior(500),
		offset = adaptive_result.optimizer[end]
		)

eu = EpitopeUncertainty(data,adaptive_result.grid, epitope_bins, 
		levels = [1e-10,1e-5,0.1,0.25,0.5,0.75,0.9,1], 
		options = adaptive_options
		)
</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EpitopeUncertainty([1.0e-10, 1.0e-5, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0], [0.002052196595207456 0.0 … 0.0 0.0; 0.0027251191089733865 0.0 … 0.0 0.0; … ; 0.004193392619654922 0.0 … 0.0 0.0; 0.004341001429126158 0.0 … 0.01171345131205015 0.008112278353753133], [0.006641231452128458 0.0051005100510051 … 0.7779900789748164 0.8246939365195698; 0.005941161445127758 0.0036003600360036 … 0.553567636730592 0.5854700141273306; … ; 0.004441011430126258 0.00020002000200020003 … 0.06351863183010195 0.06331779890580834; 0.004341001429126158 4.2168791772922093e-81 … 0.01171345131205015 0.008112278353753133], [1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5], [1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5, 1.6161874944006287e-5])</code></pre><p>Then, the <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>DoseResponseUncertainty</code></a> is constructed but with the global <code>bin</code> from <a href="#global_uncertainty">Example: Global uncertainty</a>:</p><pre><code class="language-julia hljs">dr_bins = [collect(1:length(adaptive_result.grid))]
concentrations = LogRange(extrema(data.independent)...,100)
du = DoseResponseUncertainty(adaptive_result.grid, eu, concentrations, bins = dr_bins)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DoseResponseUncertainty([1.0e-10, 1.0e-5, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0], [1.0e-10, 1.2045035402587787e-10, 1.4508287784959432e-10, 1.747528400007683e-10, 2.104904144512022e-10, 2.5353644939701164e-10, 3.0538555088334126e-10, 3.6783797718286343e-10, 4.4306214575838866e-10, 5.336699231206324e-10  …  0.0018738174228603867, 0.002257019719633926, 0.002718588242732946, 0.0032745491628777385, 0.0039442060594376644, 0.004750810162102803, 0.0057223676593502314, 0.00689261210434971, 0.00830217568131977, 0.010000000000000016], [0.00013540591971471499 0.00015974855137897414 … 0.7866175811204656 0.7866175811204656; 0.0001574647242169009 0.0001863047013409774 … 1.0464284308927578 1.0464284308927578; … ; 0.00020946015679829908 0.00024890317515173846 … 1.9532756948723933 1.9547599603155579; 0.00021495651447645886 0.0002555205168973023 … 2.1213134294695 2.127985108306521], [0.0003507835446011125 0.0004190598087836483 … 5.297413381830167 5.433405499119724; 0.0003104691202920344 0.0003705205123995375 … 4.366937239368505 4.465044877979099; … ; 0.00022237178222279933 0.0002644493729006822 … 2.334449149206481 2.3498546726569853; 0.00021495651447645886 0.0002555205168973023 … 2.1213134294695 2.127985108306521])</code></pre><img src="e1a19e0d.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Interpretation</header><div class="admonition-body"><p>For the uncertainty of the <span>$K_\tau$</span>-density, the interpretation of the uncertainty levels is the same as before in <a href="#individual_uncertainty">Example: Individual uncertainty</a> and <a href="#in_single_peak">Example: Uncertainty in a single peak</a>. Only a single parameter at a time can be considered while keeping the other parameters fixed to the best fit result.</p><p>However, the correspondence between the dose-response uncertainty and the density uncertainty is different. An uncertainty level in the dose-response plot now corresponds to any parameter <strong>combination</strong> in the density plot that is withing the same uncertainty level.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Fitting/">« Fitting</a><a class="docs-footer-nextpage" href="../API/">AntibodyMethodsDoseResponse »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 26 July 2024 00:13">Friday 26 July 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
