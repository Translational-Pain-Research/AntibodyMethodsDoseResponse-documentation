<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AntibodyMethodsDoseResponse · AntibodyMethodsDoseResponse</title><meta name="title" content="AntibodyMethodsDoseResponse · AntibodyMethodsDoseResponse"/><meta property="og:title" content="AntibodyMethodsDoseResponse · AntibodyMethodsDoseResponse"/><meta property="twitter:title" content="AntibodyMethodsDoseResponse · AntibodyMethodsDoseResponse"/><meta name="description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="og:description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="twitter:description" content="Documentation for AntibodyMethodsDoseResponse."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="AntibodyMethodsDoseResponse logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">AntibodyMethodsDoseResponse</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../QuickStart/">Quick start</a></li><li><span class="tocitem">Detailed explanations</span><ul><li><a class="tocitem" href="../MeasurementData/">Measurement data</a></li><li><a class="tocitem" href="../Models/">Models</a></li><li><a class="tocitem" href="../ResultsAndSimulations/">Results and simulations</a></li><li><a class="tocitem" href="../DensityPlots/">Density plots for <code>OneDimGrid</code></a></li><li><a class="tocitem" href="../Fitting/">Fitting</a></li><li><a class="tocitem" href="../Uncertainty/">Uncertainty estimation</a></li></ul></li><li><span class="tocitem">API</span><ul><li class="is-active"><a class="tocitem" href>AntibodyMethodsDoseResponse</a><ul class="internal"><li><a class="tocitem" href="#Measurement-data-processing"><span>Measurement data processing</span></a></li><li><a class="tocitem" href="#Depletion-correction-of-measurement-data"><span>Depletion correction of measurement data</span></a></li><li><a class="tocitem" href="#Models"><span>Models</span></a></li><li><a class="tocitem" href="#Result-type"><span>Result type</span></a></li><li><a class="tocitem" href="#Adaptive-fitting"><span>Adaptive fitting</span></a></li><li><a class="tocitem" href="#Convenience-methods"><span>Convenience methods</span></a></li><li><a class="tocitem" href="#Uncertainty-estimation"><span>Uncertainty estimation</span></a></li></ul></li><li><a class="tocitem" href="../API_Convenience/">AntibodyMethodsDoseResponseConvenience</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>AntibodyMethodsDoseResponse</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AntibodyMethodsDoseResponse</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/main/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Measurement-data-processing"><a class="docs-heading-anchor" href="#Measurement-data-processing">Measurement data processing</a><a id="Measurement-data-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Measurement-data-processing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.dose_response_check" href="#AntibodyMethodsDoseResponse.dose_response_check"><code>AntibodyMethodsDoseResponse.dose_response_check</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dose_response_check(fitting_data::FittingData)</code></pre><p>Test if the <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object <code>fitting_data</code> satisfies properties for dose-response data:</p><ul><li>only real numbers</li><li>numbers must be positive</li><li>no <code>NaN</code> or <code>Inf</code> in the data set</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L35-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.normalize_data" href="#AntibodyMethodsDoseResponse.normalize_data"><code>AntibodyMethodsDoseResponse.normalize_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_data!(fitting_data::FittingData; offset::Real = 0, reference::Union{Nothing,Real} = nothing)</code></pre><p>Return the <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object <code>fitting_data</code> with normalized response data and errors.</p><ul><li><code>reference = nothing</code>: The reference signal to normalize the responses to. If <code>reference = nothing</code>, the maximal response is used a reference point.</li><li><code>offset = 0</code>: Signal offset to be subtracted (applies to both the responses and the reference point).</li></ul><p>The normalization of the <code>responses</code> and <code>errors</code> are:</p><pre><code class="nohighlight hljs">new_responses = (responses - offset) / (reference - offset)
errors =  errors / (reference - offset)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L117-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.normalize_data!" href="#AntibodyMethodsDoseResponse.normalize_data!"><code>AntibodyMethodsDoseResponse.normalize_data!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_data!(fitting_data::FittingData; offset::Real = 0, reference::Union{Nothing,Real} = nothing)</code></pre><p>Normalize the <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object <code>fitting_data</code> by mutation.</p><ul><li><code>reference = nothing</code>: The reference signal to normalize the responses to. If <code>reference = nothing</code>, the maximal response is used a reference point.</li><li><code>offset = 0</code>: Signal offset to be subtracted (applies to both the responses and the reference point).</li></ul><p>The normalization of the <code>responses</code> and <code>errors</code> are:</p><pre><code class="nohighlight hljs">new_responses = (responses - offset) / (reference - offset)
errors =  errors / (reference - offset)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L52-L63">source</a></section></article><h2 id="Depletion-correction-of-measurement-data"><a class="docs-heading-anchor" href="#Depletion-correction-of-measurement-data">Depletion correction of measurement data</a><a id="Depletion-correction-of-measurement-data-1"></a><a class="docs-heading-anchor-permalink" href="#Depletion-correction-of-measurement-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.scale_bound" href="#AntibodyMethodsDoseResponse.scale_bound"><code>AntibodyMethodsDoseResponse.scale_bound</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale_bound(fitting_data::FittingData)</code></pre><p>Get the upper bound for the scale factor <code>β</code> s.t.  <code>a_i - β*r_i ≥ 0</code>, where <code>r_i</code> are the responses and <code>a_i</code> are the (initial) antibody concentrations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L159-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.simple_depletion_correction" href="#AntibodyMethodsDoseResponse.simple_depletion_correction"><code>AntibodyMethodsDoseResponse.simple_depletion_correction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simple_depletion_correction(fitting_data::FittingData,scale::Real)</code></pre><p>Return the depletion-corrected <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object.</p><p>The concentrations are corrected to <code>concentration - scale * response</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L215-L220">source</a></section><section><div><pre><code class="language-julia hljs">simple_depletion_correction(fitting_data::FittingData)</code></pre><p>Return depletion-corrected <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object using the largest possible scale factor.</p><p>The concentrations are corrected to <code>concentration - scale * response</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L228-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.simple_depletion_correction!" href="#AntibodyMethodsDoseResponse.simple_depletion_correction!"><code>AntibodyMethodsDoseResponse.simple_depletion_correction!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simple_depletion_correction!(fitting_data::FittingData,scale::Real)</code></pre><p>Depletion-correct the <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object <code>fitting_data</code> by mutation.</p><p>The concentrations are corrected to <code>concentration - scale * response</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L244-L249">source</a></section><section><div><pre><code class="language-julia hljs">simple_depletion_correction!(fitting_data::FittingData)</code></pre><p>Depletion-correct the <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.FittingData"><code>FittingData</code></a> object <code>fitting_data</code> by mutation, using the largest possible scale factor.</p><p>The concentrations are corrected to <code>concentration - scale * response</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Data.jl#L259-L264">source</a></section></article><h2 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.accumulation_model" href="#AntibodyMethodsDoseResponse.accumulation_model"><code>AntibodyMethodsDoseResponse.accumulation_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">accumulation_model(grid::OneDimGrid; offset = nothing)</code></pre><p>Create a multi-epitope accumulation model. Returns <code>(model,λ,centers,volumes)</code> where </p><ul><li><code>model</code> is a <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.ModelFunctions"><code>ModelFunctions</code></a> object.</li><li><code>λ</code> is an initial parameter array (the weights of the grid and the offset if <code>offset != nothing</code>). If <code>offset != nothing</code>, the last element is the offset parameter <code>λ[end] = offset</code>.</li><li><code>centers</code> and <code>volumes</code> are the remaining properties of the grid, see <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_all"><code>export_all</code></a></li></ul><p><strong>Model function</strong></p><p>The following model function and partial derivatives are used:</p><p class="math-container">\[\text{model}(a,\lambda) = \lambda_e + \sum_i \lambda_i \left(1-e^{-\frac{a}{c_i}}\right)  \approx  \lambda_e + \sum_i \int_{l_i}^{u_i} \frac{\lambda_i}{u_i-l_i}\left(1-e^{-\frac{a}{k}}\right) \ dk \]</p><p class="math-container">\[\partial_{\lambda_j} \text{model}(a,\lambda) = 1-e^{-\frac{a}{c_i}} \quad, \qquad \partial_{\lambda_e} \text{model}(a,\lambda) = 1\]</p><p>where <span>$a$</span> is the antibody concentration, <span>$c_i$</span> are the centers of the <code>grid</code> intervals <span>$[u_i,l_i]$</span> and <span>$\lambda_e$</span> is the offset (if <code>offset != nothing</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Models.jl#L52-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.langmuir_model" href="#AntibodyMethodsDoseResponse.langmuir_model"><code>AntibodyMethodsDoseResponse.langmuir_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">langmuir_model(grid::OneDimGrid; offset = nothing)</code></pre><p>Create a multi-epitope Langmuir model. Returns <code>(model,λ,centers,volumes)</code> where </p><ul><li><code>model</code> is a <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.ModelFunctions"><code>ModelFunctions</code></a> object.</li><li><code>λ</code> is an initial parameter array (the weights of the grid and the offset if <code>offset != nothing</code>). If <code>offset != nothing</code>, the last element is the offset parameter <code>λ[end] = offset</code>.</li><li><code>centers</code> and <code>volumes</code> are the remaining properties of the grid, see <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_all"><code>export_all</code></a>.</li></ul><p><strong>Model function</strong></p><p>The following model function and partial derivatives are used:</p><p class="math-container">\[\text{model}(a,\lambda) = \lambda_e + \sum_i \frac{\lambda_i\cdot a}{ (u_i - l_i)} \ln\left(\frac{a+u_i}{a+l_i}\right)  =  \lambda_e + \sum_i \int_{l_i}^{u_i} \frac{\frac{\lambda_i}{u_i - l_i}}{1+\frac{k}{a}} \ dk \]</p><p class="math-container">\[\partial_{\lambda_j} \text{model}(a,\lambda) = \frac{a}{u_j-l_j} \ln\left(\frac{a+u_j}{a+l_j}\right)\quad, \qquad \partial_{\lambda_e} \text{model}(a,\lambda) = 1\]</p><p>where <span>$a$</span> is the antibody concentration, <span>$[l_i,u_i]$</span> are the intervals of the <code>grid</code> and <span>$\lambda_e$</span> is the offset (if <code>offset != nothing</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Models.jl#L163-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.accumulation_inv_const_model" href="#AntibodyMethodsDoseResponse.accumulation_inv_const_model"><code>AntibodyMethodsDoseResponse.accumulation_inv_const_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">accumulation_inv_const_model(grid::OneDimGrid; offset = nothing)</code></pre><p>Create a multi-epitope accumulation model with <code>1/K_τ = k_a * τ</code> as constant domain. Returns <code>(model,λ,centers,volumes)</code> where </p><ul><li><code>model</code> is a <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.ModelFunctions"><code>ModelFunctions</code></a> object.</li><li><code>λ</code> is an initial parameter array (the weights of the grid and the offset if <code>offset != nothing</code>). If <code>offset != nothing</code>, the last element is the offset parameter <code>λ[end] = offset</code>.</li><li><code>centers</code> and <code>volumes</code> are the remaining properties of the grid, see <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_all"><code>export_all</code></a></li></ul><p><strong>Model function</strong></p><p>The following model function and partial derivatives are used:</p><p class="math-container">\[\text{model}(a,\lambda) = \lambda_e + \sum_i \lambda_i \left(1+\frac{1}{a\cdot(u_i-l_i)}\left(e^{-a u_i}-e^{-a l_i} \right) \right) =   \lambda_e + \sum_i \int_{l_i}^{u_i} \frac{\lambda_i}{u_i-l_i}\left(1-e^{-a k}\right) \ dk \]</p><p class="math-container">\[\partial_{\lambda_j} \text{model}(a,\lambda) = 1+\frac{1}{a\cdot(u_i-l_i)}\left(e^{-a u_i}-e^{-a l_i} \right) \quad, \qquad \partial_{\lambda_e} \text{model}(a,\lambda) = 1\]</p><p>where <span>$a$</span> is the antibody concentration, <span>$c_i$</span> are the centers of the <code>grid</code> intervals <span>$[u_i,l_i]$</span> and <span>$\lambda_e$</span> is the offset (if <code>offset != nothing</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Models.jl#L101-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.langmuir_inv_const_model" href="#AntibodyMethodsDoseResponse.langmuir_inv_const_model"><code>AntibodyMethodsDoseResponse.langmuir_inv_const_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">langmuir_inv_const_model(grid::OneDimGrid; offset = nothing)</code></pre><p>Create a multi-epitope Langmuir model with <code>1/K_d = k_a / k_d</code> as constant domain. Returns <code>(model,λ,centers,volumes)</code> where </p><ul><li><code>model</code> is a <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.ModelFunctions"><code>ModelFunctions</code></a> object.</li><li><code>λ</code> is an initial parameter array (the weights of the grid and the offset if <code>offset != nothing</code>). If <code>offset != nothing</code>, the last element is the offset parameter <code>λ[end] = offset</code>.</li><li><code>centers</code> and <code>volumes</code> are the remaining properties of the grid, see <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_all"><code>export_all</code></a></li></ul><p><strong>Model function</strong></p><p>The following model function and partial derivatives are used:</p><p class="math-container">\[\text{model}(a,\lambda) = \lambda_e + \sum_i \lambda_i \left(1+ \frac{1}{a\cdot (u_i-l_i)} \ln\left(\frac{a l_i +1}{a u_i +1}\right)\right)  = \lambda_e + \sum_i \int_{l_i}^{u_i} \frac{\frac{\lambda_i}{u_i - l_i}}{1+\frac{1}{a\cdot k}} \ dk  \]</p><p class="math-container">\[\partial_{\lambda_j} \text{model}(a,\lambda) = 1+ \frac{1}{a\cdot (u_i-l_i)} \ln\left(\frac{a l_i +1}{a u_i +1}\right)\quad, \qquad \partial_{\lambda_e} \text{model}(a,\lambda) = 1\]</p><p>where <span>$a$</span> is the antibody concentration, <span>$[l_i,u_i]$</span> are the intervals in the <code>grid</code> and <span>$\lambda_e$</span> is the offset (if <code>offset != nothing</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Models.jl#L216-L235">source</a></section></article><h2 id="Result-type"><a class="docs-heading-anchor" href="#Result-type">Result type</a><a id="Result-type-1"></a><a class="docs-heading-anchor-permalink" href="#Result-type" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.DoseResponseResult" href="#AntibodyMethodsDoseResponse.DoseResponseResult"><code>AntibodyMethodsDoseResponse.DoseResponseResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct DoseResponseResult</code></pre><p>Data type to store dose-response result data (e.g. from a dose-response-curve fitting or a simulation).	</p><p><strong>Fields</strong></p><ul><li><code>concentrations</code>: Antibody concentrations.</li><li><code>responses</code>: Response values.</li></ul><p><strong>Default constructor</strong></p><pre><code class="nohighlight hljs">DoseResponseResult(concentrations,responses)</code></pre><p><strong>Model constructor</strong></p><pre><code class="nohighlight hljs">DoseResponseResult(grid::OneDimGrid,concentrations; 
	offset::Real = 0,
	model::Function = accumulation_model
)</code></pre><p>Calculate a dose-response curve from a K_τ <code>grid</code> and a <code>model</code> for given <code>concentrations</code>. The <code>offset</code> value is a global additive shift for all response values.</p><p>The available model functions are <a href="#AntibodyMethodsDoseResponse.accumulation_model"><code>accumulation_model</code></a>, <a href="#AntibodyMethodsDoseResponse.accumulation_inv_const_model"><code>accumulation_inv_const_model</code></a>, <a href="#AntibodyMethodsDoseResponse.langmuir_model"><code>langmuir_model</code></a> and <a href="#AntibodyMethodsDoseResponse.langmuir_inv_const_model"><code>langmuir_inv_const_model</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Models.jl#L304-L327">source</a></section></article><h2 id="Adaptive-fitting"><a class="docs-heading-anchor" href="#Adaptive-fitting">Adaptive fitting</a><a id="Adaptive-fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Adaptive-fitting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.AdaptiveOptions" href="#AntibodyMethodsDoseResponse.AdaptiveOptions"><code>AntibodyMethodsDoseResponse.AdaptiveOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct AdaptiveOptions</code></pre><p>Data type to define <a href="#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>adaptive_dose_response_fit</code></a> options.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">AdaptiveOptions(keywords...)</code></pre><p>The following keywords (with default values) are available:</p><ul><li><code>name::AbstractString = &quot;Adaptive optimization&quot;</code>: The name that is used when <code>show_progress==true</code>.</li><li><code>show_progress::Bool = true</code>: Show progress in standard output.</li><li><code>iterations::Integer = 1</code>: Number of refinement iterations.</li><li><code>model::Function = accumulation_model</code>: The model-function that is used for the data-fit. The available model functions are <a href="#AntibodyMethodsDoseResponse.accumulation_model"><code>accumulation_model</code></a>, <a href="#AntibodyMethodsDoseResponse.accumulation_inv_const_model"><code>accumulation_inv_const_model</code></a>, <a href="#AntibodyMethodsDoseResponse.langmuir_model"><code>langmuir_model</code></a> and <a href="#AntibodyMethodsDoseResponse.langmuir_inv_const_model"><code>langmuir_inv_const_model</code></a>.</li><li><code>offset = nothing</code>: Offset parameter for the model function. If <code>nothing</code>, no offset is used.</li><li><code>objective::Symbol = :lsq</code>. The objective function for the data-fit. Available are <code>:lsq</code>, <code>:posterior</code> and <code>:log_posterior</code>.</li><li><code>prior_generator::Function = default_prior_generator</code>: The function that generates the prior. The function must have the signature <code>(grid_centers,grid_volumes,offset)</code> and must return a function <code>λ-&gt; prior(λ)</code> or <code>λ-&gt; log_prior(λ)</code> in case of a <code>:log_posterior</code> objective. The <code>default_prior_generator</code> generates a uniform prior <code>λ-&gt; 0</code> for the log-posterior objective.</li><li><code>distribution_derivatives = nothing</code>: Array of partial derivatives of the logarithmic distributions for the log-posterior objective. See <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.log_posterior_gradient"><code>log_posterior_gradient</code></a>.</li><li><code>prior_gradient_generator = default_prior_gradient_generator</code>: The function that generates the log-prior gradient (see  <a href="https://translational-pain-research.github.io/FittingObjectiveFunctions-documentation/API/#FittingObjectiveFunctions.log_posterior_gradient"><code>log_posterior_gradient</code></a>). The function must have the signature <code>(grid_centers,grid_volumes,offset)</code> and must return a function <code>λ-&gt; ∇log_prior(λ)</code>. The <code>default_prior_gradient_generator</code> returns <code>nothing</code> which internally corresponds to the uniform prior for the log-posterior objective.</li><li><code>block_variation::Function =</code> <a href="#AntibodyMethodsDoseResponse.log_area_scaled_variation"><code>log_area_scaled_variation</code></a> and <code>selection::Function = maximum</code> are the refinement options of <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.refine!"><code>refine!</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/AdaptiveFitting.jl#L75-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.area_scaled_variation" href="#AntibodyMethodsDoseResponse.area_scaled_variation"><code>AntibodyMethodsDoseResponse.area_scaled_variation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">area_scaled_variation(center, volume, weight, 
	neighbor_centers, neighbor_volumes, neighbor_weights)</code></pre><p>Block variation function for <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.refine!"><code>refine!</code></a>. Variation value based on the difference of the weights, scaled with the area (volume) of the corresponding block.</p><pre><code class="nohighlight hljs">mean(@. abs(weight * volume - neighbor_weights * neighbor_volumes))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/AdaptiveFitting.jl#L11-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.log_area_scaled_variation" href="#AntibodyMethodsDoseResponse.log_area_scaled_variation"><code>AntibodyMethodsDoseResponse.log_area_scaled_variation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">log_area_scaled_variation(center, volume, weight, 
	neighbor_centers, neighbor_volumes, neighbor_weights)</code></pre><p>Block variation function for <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.refine!"><code>refine!</code></a>. Variation value based on the difference of the weight, scaled with the visible area (in a logarithmic plot) of the corresponding block.</p><pre><code class="nohighlight hljs">log_volume = (log10(center + volume / 2) - log10(center - volume / 2))
neighbor_log_volumes = @. (log10(neighbor_centers + neighbor_volumes / 2) - log10(neighbor_centers - neighbor_log_volumes / 2))
mean(@. abs(weight * log_volume  - neighbor_weights * neighbor_log_volumes))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/AdaptiveFitting.jl#L23-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.adaptive_dose_response_fit" href="#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>AntibodyMethodsDoseResponse.adaptive_dose_response_fit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adaptive_dose_response_fit(initial_grid::OneDimGrid, 
	data::FittingData, 
	minimizer::Function; 
	options::AdaptiveOptions=AdaptiveOptions()
)</code></pre><p>Fit dose-response <code>data</code> (with adaptive grid refinements depending on the <code>options</code>) and return an <a href="#AntibodyMethodsDoseResponse.AdaptiveResult"><code>AdaptiveResult</code></a> object. The initial gird is not mutated. For the <a href="#AntibodyMethodsDoseResponse.AdaptiveResult"><code>AdaptiveResult</code></a> object a copy of the gird is created.</p><p><strong>Minimizer function</strong></p><ul><li>The sign of posterior and log-posterior objectives is flipped for consistency reasons. A minimizer needs to be used for all objectives (<code>:lsq</code>, <code>:posterior</code>, <code>:log_posterior</code>).</li><li><code>minimizer</code>: The function that minimizes the objective function. It needs to be specified by the user and must have the signature <code>(objective_function, objective_gradient!,parameters)</code>.</li><li>The <code>objective_function</code> always has the signature <code>(parameters)</code>.</li><li>The <code>objective_gradient!</code> can be <code>nothing</code>. Otherwise it must have the signature <code>(gradient_vector, parameter)</code>. It must mutate the <code>gradient_vector</code> and return the mutated <code>gradient_vector</code>.</li><li><code>parameters</code> is the initial parameter array to start minimization from.</li></ul><p><strong>Gradients for minimization</strong></p><p>Whether <code>objective_gradient!</code> is <code>nothing</code> or a proper function depends on the specified <code>options</code> (see <a href="#AntibodyMethodsDoseResponse.AdaptiveOptions"><code>AdaptiveOptions</code></a>).</p><ul><li>The <code>:lsq</code> objective always provides analytical gradients.</li><li>The <code>:posterior</code> objective never provides analytical gradients. </li><li>The<code>:log_posterior</code> objective only provides analytical gradients if <code>distribution_derivatives != nothing</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/AdaptiveFitting.jl#L229-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.AdaptiveResult" href="#AntibodyMethodsDoseResponse.AdaptiveResult"><code>AntibodyMethodsDoseResponse.AdaptiveResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct AdaptiveResult</code></pre><p>Data type used by <a href="#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>adaptive_dose_response_fit</code></a> to summarize the results.</p><p>The struct has the following fields:</p><ul><li><code>result</code>: The <a href="#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a> object corresponding to the fit result.</li><li><code>grid</code>: The grid (with imported weights) corresponding to the fit result.</li><li><code>optimizer</code>: The raw result parameter.</li><li><code>objective_value</code>: The objective-function value of <code>optimizer</code>.</li><li><code>time</code>: The elapsed time for the model fit (in seconds).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/AdaptiveFitting.jl#L138-L149">source</a></section></article><h2 id="Convenience-methods"><a class="docs-heading-anchor" href="#Convenience-methods">Convenience methods</a><a id="Convenience-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Convenience-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.LogRange" href="#AntibodyMethodsDoseResponse.LogRange"><code>AntibodyMethodsDoseResponse.LogRange</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LogRange(start::Real,stop::Real,n::Integer, base::Real = 10.0)</code></pre><p>Return a vector with <code>n</code> values logarithmically distributed between <code>start</code> and <code>stop</code>. The logarithm <code>base</code> can be changed with the last, optional argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/GeneralMethods.jl#L11-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.peak_detection" href="#AntibodyMethodsDoseResponse.peak_detection"><code>AntibodyMethodsDoseResponse.peak_detection</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peak_detection(grid::OneDimGrid, relative_threshold::Real = 0.1; 
	volume_normalization::Symbol = :log, 
	fill::Bool = true
)</code></pre><p>Return <code>(peak_group_indices,peak_group_domains)</code> w.r.t. the <code>relativ_ threshold</code>.</p><ul><li><code>peak_group_indices</code> contains the index-vectors of the peaks. The index order is the order of <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_weights"><code>export_weights</code></a> and <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.export_all"><code>export_all</code></a>.</li><li><code>peak_group_domains</code> contains the intervals covered by the respective peaks.</li><li>The cutoff threshold is determined by <code>relative_threshold * largest_weight</code>.</li><li>If <code>fill == true</code>, the gaps between the peaks are added to <code>peak_group_indices</code> and <code>peak_group_domains</code>.</li><li><code>volume_normalization</code> normalizes the weights of the grid (without mutation) before the peaks are determined. <code>:none</code> uses the raw weights. <code>:linear</code> divides the weights by the block volume and <code>:log</code> divides the weight by the block volume in a logarithmic scale.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/Convenience/GeneralMethods.jl#L67-L80">source</a></section></article><h2 id="Uncertainty-estimation"><a class="docs-heading-anchor" href="#Uncertainty-estimation">Uncertainty estimation</a><a id="Uncertainty-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Uncertainty-estimation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.EpitopeUncertainty" href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>AntibodyMethodsDoseResponse.EpitopeUncertainty</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EpitopeUncertainty</code></pre><p>Data type to store uncertainty estimates for the <code>weights</code> of a K_τ <code>grid</code>.</p><p><strong>Fields</strong></p><ul><li><code>levels</code>: List of uncertainty levels. They can be sample quantiles or fractions of the best objective value, depending on the constructor.</li><li><code>lower</code>: Matrix of estimated lower bounds for the weights at the corresponding uncertainty levels (dimension order : [level, grid parameter index]).</li><li><code>upper</code>: Matrix of estimated upper bounds for the wights at the corresponding uncertainty levels (dimension order : [level, gird parameter index]).</li><li><code>lower_offset</code>: Vector of lower bounds for the offset parameter corresponding to the uncertainty levels.</li><li><code>upper_offset</code>: Vector of upper bounds for the offset parameter corresponding to the uncertainty levels.</li></ul><hr/><hr/><p><strong>Default constructor</strong></p><pre><code class="nohighlight hljs">EpitopeUncertainty(levels, lower, upper, lower_offset= nothing, upper_offset = nothing)</code></pre><hr/><hr/><p><strong>Construction from bin-wise shifting</strong></p><pre><code class="nohighlight hljs">EpitopeUncertainty(data::FittingData,grid::OneDimGrid, bins = collect(1:length(grid)); 
	keywords...)</code></pre><p>Estimate uncertainty by shifting all grid weights uniformly, one bin at a time, while keeping the other bins fixed. Admissible weights (for a given level) are determined by calculating the objective-function value (objective function automatically generated) for the shifted weights.</p><p>The bins can be defined as vector of indices, e.g. <code>[[1,2,3],[4,5,6]]</code> or <code>[1,3,5]</code> which is converted to <code>[[1],[3],[5]]</code>. To obtain bin indices from the grid-domain, use <a href="https://translational-pain-research.github.io/AdaptiveDensityApproximation-documentation/api/#AdaptiveDensityApproximation.select_indices"><code>select_indices</code></a>.</p><p>The following keywords are available:</p><ul><li><code>levels = collect(0.1:0.1:1)</code>: The uncertainty levels as fractions of the best objective value.</li><li><code>steps::Integer = 10^4</code>: Number of intermediate shifts to be tested. The maximal shift range is determined automatically.</li><li><code>bisections::Integer = 10^2</code>: Number of interval-bisection steps to determine the maximal shift range.</li><li><code>volume_normalization = :none</code>: Changes the scaling of the weight shifts for each individual weight in a bin. Use <code>:none</code> to apply the same shift for each weight. Use <code>:linear</code> to scale the shifts with the interval volumes corresponding to the weights.  And use <code>:log</code> to scale the sifts with the visual interval volumes (as they appear in a logarithmic plot) corresponding to the weights.</li><li><code>options::AdaptiveOptions = AdaptiveOptions()</code>: The objective function is automatically generated, using the same construction as <a href="#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>adaptive_dose_response_fit</code></a>. See <a href="#AntibodyMethodsDoseResponse.AdaptiveOptions"><code>AdaptiveOptions</code></a> and <a href="#AntibodyMethodsDoseResponse.adaptive_dose_response_fit"><code>adaptive_dose_response_fit</code></a> for the details. To use the offset estimation from a fit result, add the estimated value to the <a href="#AntibodyMethodsDoseResponse.AdaptiveOptions"><code>AdaptiveOptions</code></a> with the <code>offset</code> keyword: <code>options = AdaptiveOptions(other_options..., offset = estimated_offset)</code>.</li></ul><hr/><hr/><p><strong>Construction from samples</strong></p><pre><code class="nohighlight hljs">EpitopeUncertainty(samples; keywords... )</code></pre><p>Estimate the uncertainty as credibility intervals (symmetric interval around the median) from <code>samples</code> (drawn from a posterior distribution). The samples can either be passed as array of samples (parameters) or as matrix (order: [parameter index, sample index]).</p><p>The following keywords are available:</p><ul><li><code>levels = collect(0.1:0.1:1)</code>: The uncertainty levels as quantiles.</li><li><code>offset::Bool = false</code>: If <code>true</code> the last parameter element is treated as offset parameter, otherwise, all parameters are treated as grid weights.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/UncertaintyEstimation/TypeDefinitions.jl#L7-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AntibodyMethodsDoseResponse.DoseResponseUncertainty" href="#AntibodyMethodsDoseResponse.DoseResponseUncertainty"><code>AntibodyMethodsDoseResponse.DoseResponseUncertainty</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct DoseResponseUncertainty</code></pre><p>Data type to store uncertainty estimates for the response values of a <a href="#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a> object.</p><p><strong>Fields</strong></p><ul><li><code>levels</code>: List of uncertainty levels, corresponding to the uncertainty levels of a <a href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object (if constructed from an <code>EpitopeUncertainty</code> object).</li><li><code>concentration</code>: Vector of concentrations (no uncertainty).</li><li><code>lower</code>: Matrix of estimated lower bounds for the responses at the corresponding uncertainty level (dimension order : [level, concentration/response index]).</li><li><code>upper</code>: Matrix of estimated upper bounds for the responses at the corresponding uncertainty level (dimension order : [level, concentration/response index]).</li></ul><hr/><hr/><p><strong>Default constructor</strong></p><pre><code class="nohighlight hljs">DoseResponseUncertainty(levels,concentrations,lower,upper)</code></pre><hr/><hr/><p><strong>Construction from an EpitopeUncertainty object</strong></p><pre><code class="nohighlight hljs">DoseResponseUncertainty(grid::OneDimGrid,
	eu::EpitopeUncertainty,
	concentrations::AbstractVector; 
	keywords...
)</code></pre><p>Estimate the dose-response uncertainty from an <a href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object <code>eu</code> for the provided <code>concentrations</code>. The <code>grid</code> should be the grid that was used to create the <code>EpitopeUncertainty</code> object <code>eu</code>.</p><p>The following keywords are available:</p><ul><li><code>bins = [collect(1:length(grid))]</code>: The response bounds are calculated as point-wise minima/maxima of responses created from the grid weights, where one bin at a time is replaced with the <a href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> lower and upper bound, while keeping the other weights fixed. For the minima/maxima all response values, iterating over all bins, are considered. Ideally, the bins should correspond to the bins that were used to construct the <a href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object <code>eu</code>.</li><li><code>model::Function = accumulation_model</code>: The model that is used to calculate the response values. The available model functions are <a href="#AntibodyMethodsDoseResponse.accumulation_model"><code>accumulation_model</code></a>, <a href="#AntibodyMethodsDoseResponse.accumulation_inv_const_model"><code>accumulation_inv_const_model</code></a>, <a href="#AntibodyMethodsDoseResponse.langmuir_model"><code>langmuir_model</code></a> and <a href="#AntibodyMethodsDoseResponse.langmuir_inv_const_model"><code>langmuir_inv_const_model</code></a>.</li></ul><p>There is no <code>offset</code> keyword, as the offsets are determined by the <a href="#AntibodyMethodsDoseResponse.EpitopeUncertainty"><code>EpitopeUncertainty</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Translational-Pain-Research/AntibodyMethodsDoseResponse.jl/blob/67f4a3713905ab7d2be066a806887659f2cb1549/src/UncertaintyEstimation/TypeDefinitions.jl#L104-L144">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Uncertainty/">« Uncertainty estimation</a><a class="docs-footer-nextpage" href="../API_Convenience/">AntibodyMethodsDoseResponseConvenience »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 12 September 2024 16:02">Thursday 12 September 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
